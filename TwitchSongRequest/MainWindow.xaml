<adonisControls:AdonisWindow
    x:Class="TwitchSongRequest.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:adonisControls="clr-namespace:AdonisUI.Controls;assembly=AdonisUI"
    xmlns:converters="clr-namespace:TwitchSongRequest.Converters"
    xmlns:local="clr-namespace:TwitchSongRequest"
    xmlns:tb="http://www.hardcodet.net/taskbar"
    xmlns:wpf="clr-namespace:CefSharp.Wpf;assembly=CefSharp.Wpf"
    Title="Twitch Music Song Request Bot"
    Width="900"
    Height="600"
    Icon="Cassette.ico"
    StateChanged="AdonisWindow_StateChanged"
    TitleBarBackground="{StaticResource TitleGradientBrush}"
    WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <converters:MmSsFormatConverter x:Key="MmSsConverter" />
    </Window.Resources>

    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="150" />
            <RowDefinition Height="3*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="2*" />
        </Grid.RowDefinitions>

        <tb:TaskbarIcon
            IconSource="Cassette.ico"
            ToolTipText="Twitch Song Request Bot: Currently Playing: SONG NAME"
            TrayLeftMouseDown="TaskbarIcon_TrayLeftMouseDown">
            <tb:TaskbarIcon.ContextMenu>
                <ContextMenu Background="DarkGray">
                    <MenuItem Click="TrayShow_Click" Header="Open" />
                    <Separator />
                    <MenuItem Click="TrayClose_Click" Header="Exit" />
                </ContextMenu>
            </tb:TaskbarIcon.ContextMenu>
            <tb:TaskbarIcon.TrayToolTip>
                <StackPanel Background="LightGray">
                    <TextBlock Margin="4,4,4,0" Text="Twitch Song Request Bot" />
                    <TextBlock Margin="4,0" Text="Currently Playing: SONG NAME" />
                    <TextBlock Margin="4,0,4,4" Text="Platform: Spotify" />
                </StackPanel>
            </tb:TaskbarIcon.TrayToolTip>
        </tb:TaskbarIcon>

        <wpf:ChromiumWebBrowser
            x:Name="ChromeBrowser"
            Grid.Column="1"
            Address="about:blank"
            Visibility="Hidden" />

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>

            <Grid Margin="8,16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Button
                    Width="48"
                    Height="28"
                    Click="Play_Click"
                    Content="Play" />
                <Button
                    Grid.Column="1"
                    Width="48"
                    Height="28"
                    Click="Pause_Click"
                    Content="Pause" />
                <Button
                    Grid.Column="2"
                    Width="48"
                    Height="28"
                    Click="Skip_Click"
                    Content="Skip" />
                <Grid
                    Grid.Row="1"
                    Grid.ColumnSpan="3"
                    Margin="8,0"
                    VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="30" />
                    </Grid.ColumnDefinitions>
                    <Label Content="🔊" />
                    <Slider
                        x:Name="volumeSlider"
                        Grid.Column="1"
                        Margin="-4,0,8,0"
                        Maximum="100"
                        Minimum="0"
                        TickFrequency="10"
                        TickPlacement="BottomRight"
                        Value="100" />
                    <TextBlock Grid.Column="2" Text="{Binding ElementName=volumeSlider, Path=Value, StringFormat={}{0:N0}}" />
                </Grid>

                <ComboBox
                    Name="PlaybackDevicesComboBox"
                    Grid.Row="2"
                    Grid.ColumnSpan="3"
                    Height="25"
                    Margin="8,0"
                    SelectionChanged="PlaybackDevicesComboBox_SelectionChanged" />
            </Grid>

            <Grid Grid.Column="1" Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" />
                    <ColumnDefinition Width="2*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="1*" />
                </Grid.RowDefinitions>

                <Label VerticalAlignment="Center" Content="Status" />
                <Label
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="Playing" />

                <Label
                    Grid.Row="1"
                    VerticalAlignment="Center"
                    Content="Current song" />
                <Label
                    Grid.Row="1"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="SONG NAME HERE" />

                <Label
                    Grid.Row="2"
                    VerticalAlignment="Center"
                    Content="Duration" />
                <Label
                    Grid.Row="2"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="05:00" />

                <Label
                    Grid.Row="3"
                    VerticalAlignment="Center"
                    Content="Requester" />
                <Label
                    Grid.Row="3"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="deapfoo" />

                <Label
                    Grid.Row="4"
                    VerticalAlignment="Center"
                    Content="Link" />
                <Label
                    Grid.Row="4"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="https://youtube.com/watch?v=gg564dfg6" />

                <Label
                    Grid.Row="5"
                    VerticalAlignment="Center"
                    Content="Platform" />
                <Label
                    Grid.Row="5"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="Youtube" />

                <Grid
                    Grid.Row="6"
                    Grid.ColumnSpan="3"
                    VerticalAlignment="Center">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="30" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="30" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding ElementName=songPositionSlider, Path=Value, Converter={StaticResource MmSsConverter}}" />
                    <Slider
                        x:Name="songPositionSlider"
                        Grid.Column="1"
                        Margin="8,0,8,0"
                        Maximum="360"
                        Minimum="0"
                        Value="100" />
                    <TextBlock Grid.Column="2" Text="10:00" />
                </Grid>
            </Grid>

            <Grid Grid.Column="2" Margin="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="3*" />
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="2*" />
                    <RowDefinition Height="2*" />
                    <RowDefinition Height="2*" />
                    <RowDefinition Height="3*" />
                </Grid.RowDefinitions>

                <Button
                    Grid.Column="2"
                    Width="85"
                    Height="25"
                    Margin="16,0"
                    HorizontalAlignment="Right"
                    Click="Button_Click"
                    Content="Setup" />

                <Label
                    Grid.Row="2"
                    VerticalAlignment="Center"
                    Content="Twitch Broadcaster" />
                <Label
                    Grid.Row="2"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="Connected"
                    Foreground="Green" />

                <Label
                    Grid.Row="3"
                    VerticalAlignment="Center"
                    Content="Twitch Bot" />
                <Label
                    Grid.Row="3"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="Not connected"
                    Foreground="Yellow" />

                <Label
                    Grid.Row="4"
                    VerticalAlignment="Center"
                    Content="Spotify" />
                <Label
                    Grid.Row="4"
                    Grid.Column="1"
                    VerticalAlignment="Center"
                    Content="Disconnected"
                    Foreground="Red" />

            </Grid>

        </Grid>

        <DockPanel Grid.Row="1">
            <DockPanel Margin="8,0" DockPanel.Dock="Top">
                <Label
                    Margin="8,0"
                    VerticalAlignment="Bottom"
                    Content="Queue" />
                <StackPanel
                    Margin="8,0"
                    HorizontalAlignment="Right"
                    Orientation="Horizontal">
                    <CheckBox Content="Refund all?" />
                    <Button
                        Width="85"
                        Height="25"
                        Margin="16,0"
                        Content="Clear queue" />
                </StackPanel>
            </DockPanel>

            <ListView
                Name="SongRequestsListView"
                Margin="16,8"
                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                SizeChanged="SongRequestsListView_SizeChanged">
                <ListView.View>
                    <GridView AllowsColumnReorder="False">
                        <GridView.ColumnHeaderContainerStyle>
                            <Style BasedOn="{StaticResource {x:Type GridViewColumnHeader}}" TargetType="{x:Type GridViewColumnHeader}">
                                <Setter Property="IsHitTestVisible" Value="False" />
                            </Style>
                        </GridView.ColumnHeaderContainerStyle>
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding SongName}"
                            Header="Name" />
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding Duration, Converter={StaticResource MmSsConverter}}"
                            Header="Duration" />
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding Requester}"
                            Header="Requester" />
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding Url}"
                            Header="Url" />
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding Platform}"
                            Header="Platform" />
                        <GridViewColumn Width="Auto" Header="">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Button Background="Red" Content="🗑️" />
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
            </ListView>
        </DockPanel>

        <GridSplitter
            Grid.Row="2"
            Height="4"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            ResizeBehavior="PreviousAndNext"
            ResizeDirection="Rows" />

        <DockPanel Grid.Row="3">
            <Grid Margin="16,0" DockPanel.Dock="Top">
                <Label VerticalAlignment="Bottom" Content="History" />
                <Button
                    Width="85"
                    Height="25"
                    Margin="16,0"
                    HorizontalAlignment="Right"
                    Content="Clear history" />
            </Grid>

            <ListView
                Name="SongRequestsHistoryListView"
                Grid.Row="2"
                Margin="16,8"
                ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                SizeChanged="SongRequestsHistoryListView_SizeChanged">
                <ListView.View>
                    <GridView AllowsColumnReorder="False">
                        <GridView.ColumnHeaderContainerStyle>
                            <Style BasedOn="{StaticResource {x:Type GridViewColumnHeader}}" TargetType="{x:Type GridViewColumnHeader}">
                                <Setter Property="IsHitTestVisible" Value="False" />
                            </Style>
                        </GridView.ColumnHeaderContainerStyle>
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding SongName}"
                            Header="Name" />
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding Duration, Converter={StaticResource MmSsConverter}}"
                            Header="Duration" />
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding Requester}"
                            Header="Requester" />
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding Url}"
                            Header="Url" />
                        <GridViewColumn
                            Width="Auto"
                            DisplayMemberBinding="{Binding Platform}"
                            Header="Platform" />
                        <GridViewColumn Width="Auto" Header="">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <Button
                                            Background="Cyan"
                                            Content="🔄"
                                            Foreground="Black" />
                                        <Button
                                            Margin="4,0,0,0"
                                            Background="Red"
                                            Content="🗑️" />
                                    </StackPanel>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                    </GridView>
                </ListView.View>
            </ListView>
        </DockPanel>

        <Grid
            x:Name="SetupGrid"
            Grid.RowSpan="4"
            Visibility="Collapsed">
            <local:SetupUserControl />
        </Grid>


    </Grid>

</adonisControls:AdonisWindow>